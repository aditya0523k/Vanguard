<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Secure Payment Architecture Simulation</title><script src="https://cdn.tailwindcss.com"></script><script type="importmap">{"imports":{"three":"https://cdn.jsdelivr.net/npm/three@0.163.0/build/three.module.js","three/addons/":"https://cdn.jsdelivr.net/npm/three@0.163.0/examples/jsm/"}}</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"><style>body{margin:0;font-family:'Inter',sans-serif;overflow:hidden;background:#0a0e1a;color:white}
#container{position:relative;width:100vw;height:100vh}
#background-particles{position:absolute;top:0;left:0;width:100%;height:100%}
#infoPanel{position:absolute;top:20px;left:20px;background:rgba(26,32,44,0.95);border-radius:8px;padding:20px;width:300px;max-height:80vh;overflow-y:auto;box-shadow:0 4px 6px rgba(0,0,0,0.3);z-index:10}
#infoPanel.hidden{display:none}
#closeInfo{position:absolute;top:10px;right:10px;background:none;border:none;color:white;font-size:20px;cursor:pointer}
#tabs{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0}.tab{flex:1;padding:8px;background:rgba(255,255,255,0.1);border-radius:4px;cursor:pointer;text-align:center;transition:background 0.3s}.tab.active{background:#4a90e2}.tab-pane{margin-top:10px}.tab-pane.hidden{display:none}
#progressBar{width:100%;height:6px;background:rgba(255,255,255,0.1);border-radius:3px;margin-top:10px}
#progressFill{height:100%;background:#4a90e2;border-radius:3px;transition:width 0.3s}
#timeline{margin-top:20px;display:flex;flex-direction:column;gap:10px}.timeline-step{display:flex;align-items:center;gap:10px;padding:8px;background:rgba(255,255,255,0.05);border-radius:4px;cursor:pointer;transition:background 0.3s}.timeline-step.active{background:#4a90e2}.timeline-step i{font-size:12px}
#legend{margin-top:20px;font-size:12px}.legend-color{display:inline-block;width:12px;height:12px;margin-right:8px;border-radius:2px}
#controls{position:absolute;bottom:20px;right:20px;background:rgba(26,32,44,0.95);border-radius:8px;padding:20px;width:300px;box-shadow:0 4px 6px rgba(0,0,0,0.3);z-index:10}
#controls.hidden{display:none}
#closeControls{position:absolute;top:10px;right:10px;background:none;border:none;color:white;font-size:20px;cursor:pointer}.control-group{margin-bottom:20px}.control-buttons{display:flex;flex-wrap:wrap;gap:10px}.control-button{flex:1;padding:10px;background:#4a90e2;border:none;border-radius:4px;color:white;cursor:pointer;position:relative;transition:background 0.3s;text-align:center}.control-button:hover.tooltip{visibility:visible;opacity:1}.control-button.attack{background:#ff6b6b}.control-button.reset{background:#6b7280}.tooltip{visibility:hidden;position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:#1a202c;color:white;padding:6px 10px;border-radius:4px;font-size:12px;white-space:nowrap;z-index:20;opacity:0;transition:opacity 0.3s}
#toggleInfo,#toggleControls{position:absolute;background:#4a90e2;border:none;border-radius:50%;width:40px;height:40px;color:white;font-size:24px;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 4px rgba(0,0,0,0.3)}
#toggleInfo{top:20px;left:20px}
#toggleControls{bottom:20px;right:20px}
#branding{position:absolute;bottom:20px;left:20px;font-size:14px;opacity:0.7}.label{color:white;font-size:12px;text-align:center;background:rgba(0,0,0,0.5);padding:4px 8px;border-radius:4px;pointer-events:none}.label.tooltip{visibility:hidden;position:absolute;top:-40px;left:50%;transform:translateX(-50%);background:#1a202c;padding:6px 10px;border-radius:4px;font-size:10px;white-space:nowrap}.label:hover.tooltip{visibility:visible}.status{font-weight:bold}.grabbing{cursor:grabbing!important}</style></head><body><div id="container"><canvas id="background-particles"></canvas><div id="infoPanel" class="animate__animated animate__fadeIn"><button id="closeInfo" onclick="toggleInfo()">×</button><h3 class="font-bold">Secure Payment Simulation</h3><div id="tabs"><div class="tab active" onclick="showTab('overview')"><i class="fas fa-info-circle"></i>Overview</div><div class="tab" onclick="showTab('vanguard')"><i class="fas fa-shield-alt"></i>Vanguard</div><div class="tab" onclick="showTab('asthanguard')"><i class="fas fa-user-shield"></i>Asthanguard</div><div class="tab" onclick="showTab('yudiran')"><i class="fas fa-server"></i>Yudiran</div></div><div id="tabContent"><div id="overview" class="tab-pane active"><p id="infoText">Explore our ISO/IEC 27001-compliant architecture with Vanguard,Asthanguard,and Yudiran layers,ensuring top-tier security for web applications.</p><div id="progressBar"><div id="progressFill" style="width: 0%;"></div></div><p class="text-sm mt-2 opacity-80">Certified PCI-DSS and ISO/IEC 27001 Compliant</p></div><div id="vanguard" class="tab-pane hidden"><p><strong>Vanguard Layer</strong>:Secures user interactions(ISO/IEC 27002 A.12.4)with:</p><ul class="list-disc pl-5"><li><strong>WAF</strong>:Blocks malicious HTTP requests.</li><li><strong>MFA</strong>:Ensures secure authentication(A.9.4.2).</li><li><strong>IDS/IPS</strong>:Detects and stops intrusions(A.12.4.1).</li><li><strong>Payment Gateway</strong>:Processes payments securely(A.14.2.4).</li><li><strong>Bot Detection</strong>:Identifies malicious bots(A.12.4.3).</li><li><strong>Rate Limiter</strong>:Prevents abuse via request limits(A.12.4.4).</li><li><strong>CSP</strong>:Mitigates XSS via content policies(A.14.2.5).</li><li><strong>Geo-Fencing</strong>:Restricts access by location(A.11.1.4).</li></ul></div><div id="asthanguard" class="tab-pane hidden"><p><strong>Asthanguard Layer</strong>:Protects admin operations(ISO/IEC 27002 A.9)with:</p><ul class="list-disc pl-5"><li><strong>Firewall</strong>:Limits network access(A.13.1.1).</li><li><strong>2FA</strong>:Secures admin logins(A.9.4.2).</li><li><strong>SIEM</strong>:Monitors threats(A.12.4.1).</li><li><strong>Encryption Module</strong>:Protects sessions(A.10.1.1).</li><li><strong>EDR</strong>:Responds to endpoint threats(A.12.4.3).</li><li><strong>PAM</strong>:Manages privileged access(A.9.2.3).</li><li><strong>Secure Code Review</strong>:Ensures code integrity(A.14.2.2).</li><li><strong>Behavioral Analytics</strong>:Detects insider threats(A.12.4.2).</li></ul></div><div id="yudiran" class="tab-pane hidden"><p><strong>Yudiran Layer</strong>:Safeguards backend systems(ISO/IEC 27002 A.8,A.12)with:</p><ul class="list-disc pl-5"><li><strong>DLP</strong>:Prevents data leaks(A.8.3.2).</li><li><strong>Tokenizer</strong>:Secures sensitive data(A.10.1.1).</li><li><strong>API</strong>:Validates requests(A.14.2.2).</li><li><strong>Audit Logger</strong>:Tracks activities(A.12.4.1).</li><li><strong>Vulnerability Scanner</strong>:Identifies weaknesses(A.12.6.1).</li><li><strong>Backup System</strong>:Ensures recovery(A.12.3.1).</li><li><strong>Zero Trust</strong>:Enforces strict verification(A.9.4.1).</li><li><strong>Intrusion Recovery</strong>:Restores systems post-attack(A.16.1.5).</li><li><strong>AI Threat Intel</strong>:Predicts threats(A.12.4.2).</li></ul></div></div><div id="timeline"></div><div id="legend"><div><span class="legend-color" style="background: #4a90e2;"></span>Vanguard Layer</div><div><span class="legend-color" style="background: #f5a623;"></span>Asthanguard Layer</div><div><span class="legend-color" style="background: #7ed321;"></span>Yudiran Layer</div><div><span class="legend-color" style="background: #ff0000;"></span>Attack</div><div><span class="legend-color" style="background: #00ff00;"></span>Success</div></div></div><button id="toggleInfo" onclick="toggleInfo()">+</button><div id="controls" class="animate__animated animate__slideInUp"><button id="closeControls" onclick="toggleControls()">×</button><div class="control-group"><h4>Normal Operations</h4><div class="control-buttons"><button class="control-button" onclick="simulate('userLogin')">User Login<span class="tooltip">Simulate a secure user login process</span></button><button class="control-button" onclick="simulate('payment')">Payment<span class="tooltip">Simulate a secure payment transaction</span></button><button class="control-button" onclick="simulate('adminAccess')">Admin Access<span class="tooltip">Simulate secure admin system access</span></button></div></div><div class="control-group"><h4>Attack Scenarios</h4><div class="control-buttons"><button class="control-button attack" onclick="simulate('bruteForce')">Brute Force<span class="tooltip">Simulate a brute force login attack</span></button><button class="control-button attack" onclick="simulate('ddos')">DDoS<span class="tooltip">Simulate a distributed denial-of-service attack</span></button><button class="control-button attack" onclick="simulate('unauthAdmin')">Unauth Admin<span class="tooltip">Simulate unauthorized admin access attempt</span></button><button class="control-button attack" onclick="simulate('dataExfiltration')">Data Exfiltration<span class="tooltip">Simulate an attempt to steal data</span></button><button class="control-button attack" onclick="simulate('sqlInjection')">SQL Injection<span class="tooltip">Simulate a SQL injection attack</span></button><button class="control-button attack" onclick="simulate('xss')">XSS<span class="tooltip">Simulate a cross-site scripting attack</span></button><button class="control-button attack" onclick="simulate('malware')">Malware<span class="tooltip">Simulate a malware infection attempt</span></button><button class="control-button attack" onclick="simulate('privilegeEscalation')">Privilege Escalation<span class="tooltip">Simulate an attempt to gain unauthorized privileges</span></button><button class="control-button attack" onclick="simulate('phishing')">Phishing<span class="tooltip">Simulate a phishing attack targeting credentials</span></button><button class="control-button attack" onclick="simulate('ransomware')">Ransomware<span class="tooltip">Simulate a ransomware attack on backend</span></button><button class="control-button attack" onclick="simulate('insiderThreat')">Insider Threat<span class="tooltip">Simulate an insider accessing data</span></button></div></div><div class="control-group"><h4>Controls</h4><div class="control-buttons"><button class="control-button reset" onclick="simulate('reset')">Reset<span class="tooltip">Reset the simulation to default state</span></button></div></div></div><button id="toggleControls" onclick="toggleControls()">+</button><div id="branding" class="animate__animated animate__fadeIn"><script type="module">import*as THREE from 'three';import{CSS2DRenderer,CSS2DObject}from 'three/addons/renderers/CSS2DRenderer.js';const CONFIG={layer:{depth:15,width:24,height:12},component:{size:1.2},animation:{packetSpeed:0.35,flashDuration:400,pulseDuration:800},rotation:{speed:0.002},colors:{vanguard:0x4a90e2,asthanguard:0xf5a623,yudiran:0x7ed321,user:0xffffff,admin:0xd0d0d0,gateway:0xbd10e0,database:0x50e3c2,token:0xf8e71c,waf:0xff6b6b,siem:0x6b7280,dlp:0x9f7aea,ids:0x00b7eb,encryption:0xaaaaaa,audit:0x6366f1,packet:0xffffff,attack:0xff0000,success:0x00ff00,shield:0x00ffff,firewall:0xff8c00,glow:0x00d4ff,malware:0x800080,botDetection:0xffa500,rateLimiter:0x4682b4,edr:0x9932cc,pam:0x20b2aa,vulnScanner:0xff4500,backup:0x32cd32,csp:0x87ceeb,geoFencing:0x228b22,secureCode:0xdda0dd,behaviorAnalytics:0xb8860b,zeroTrust:0x191970,intrusionRecovery:0xff6347,aiThreatIntel:0x00ced1}};let scene,camera,renderer,labelRenderer;let layers={},components={},animations=[],labels=[],shields=[];let isRotating=!1,lastMouseX,lastMouseY;let theta=Math.PI/2,phi=0;const center=new THREE.Vector3(0,0,-15);const infoText=document.getElementById('infoText');const progressFill=document.getElementById('progressFill');const container=document.getElementById('container');const timeline=document.getElementById('timeline');let currentSimulationSteps=[];let currentStepIndex=0;const attackScenarios=['bruteForce','ddos','unauthAdmin','dataExfiltration','sqlInjection','xss','malware','privilegeEscalation','phishing','ransomware','insiderThreat'];function toggleInfo(){const infoPanel=document.getElementById('infoPanel');const toggleButton=document.getElementById('toggleInfo');infoPanel.classList.toggle('hidden');toggleButton.style.display=infoPanel.classList.contains('hidden')?'flex':'none'}
function toggleControls(){const controls=document.getElementById('controls');const toggleButton=document.getElementById('toggleControls');controls.classList.toggle('hidden');toggleButton.style.display=controls.classList.contains('hidden')?'flex':'none'}
function initScene(){scene=new THREE.Scene();scene.background=new THREE.Color(0x0a0e1a);camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);updateCameraPosition();renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setSize(window.innerWidth,window.innerHeight);container.appendChild(renderer.domElement);labelRenderer=new CSS2DRenderer();labelRenderer.setSize(window.innerWidth,window.innerHeight);labelRenderer.domElement.style.position='absolute';labelRenderer.domElement.style.top='0px';container.appendChild(labelRenderer.domElement);scene.add(new THREE.AmbientLight(0xffffff,0.7));scene.add(new THREE.DirectionalLight(0xffffff,0.9).position.set(5,10,7.5));const grid=new THREE.GridHelper(100,50,0x2d3748,0x2d3748);grid.position.set(0,-10,-30);scene.add(grid);container.addEventListener('mousedown',onMouseDown);container.addEventListener('mousemove',onMouseMove);container.addEventListener('mouseup',onMouseUp);container.addEventListener('touchstart',onTouchStart,{passive:!1});container.addEventListener('touchmove',onTouchMove,{passive:!1});container.addEventListener('touchend',onTouchEnd);window.addEventListener('resize',()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);labelRenderer.setSize(window.innerWidth,window.innerHeight)});createArchitecture();initBackgroundParticles();animate()}
function initBackgroundParticles(){const particleCount=100;const particles=new THREE.Group();for(let i=0;i<particleCount;i++){const geometry=new THREE.SphereGeometry(0.1,8,8);const material=new THREE.MeshBasicMaterial({color:CONFIG.colors.glow,transparent:!0,opacity:0.5});const particle=new THREE.Mesh(geometry,material);particle.position.set((Math.random()-0.5)*100,(Math.random()-0.5)*50,(Math.random()-0.5)*100);particle.userData.velocity=new THREE.Vector3((Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02);particles.add(particle)}
scene.add(particles);animations.push(particles);function animateParticles(){particles.children.forEach(p=>{p.position.add(p.userData.velocity);if(p.position.x>50)p.position.x=-50;if(p.position.x<-50)p.position.x=50;if(p.position.y>25)p.position.y=-25;if(p.position.y<-25)p.position.y=25;if(p.position.z>50)p.position.z=-50;if(p.position.z<-50)p.position.z=50});requestAnimationFrame(animateParticles)}
animateParticles()}
function onMouseDown(event){if(event.button===0){isRotating=!0;lastMouseX=event.clientX;lastMouseY=event.clientY;container.classList.add('grabbing')}}
function onMouseMove(event){if(!isRotating)return;const deltaX=event.clientX-lastMouseX;const deltaY=event.clientY-lastMouseY;phi-=deltaX*CONFIG.rotation.speed;theta+=deltaY*CONFIG.rotation.speed;theta=Math.max(0.1,Math.min(Math.PI-0.1,theta));lastMouseX=event.clientX;lastMouseY=event.clientY;updateCameraPosition()}
function onMouseUp(){isRotating=!1;container.classList.remove('grabbing')}
function onTouchStart(event){if(event.touches.length===1){event.preventDefault();isRotating=!0;lastMouseX=event.touches[0].clientX;lastMouseY=event.touches[0].clientY;container.classList.add('grabbing')}}
function onTouchMove(event){if(!isRotating||event.touches.length!==1)return;event.preventDefault();const deltaX=event.touches[0].clientX-lastMouseX;const deltaY=event.touches[0].clientY-lastMouseY;phi-=deltaX*CONFIG.rotation.speed;theta+=deltaY*CONFIG.rotation.speed;theta=Math.max(0.1,Math.min(Math.PI-0.1,theta));lastMouseX=event.touches[0].clientX;lastMouseY=event.touches[0].clientY;updateCameraPosition()}
function onTouchEnd(){isRotating=!1;container.classList.remove('grabbing')}
function updateCameraPosition(){const radius=35;camera.position.set(radius*Math.sin(theta)*Math.cos(phi),radius*Math.cos(theta),radius*Math.sin(theta)*Math.sin(phi));camera.position.add(center);camera.lookAt(center)}
function showTab(tabId){document.querySelectorAll('.tab').forEach(tab=>tab.classList.remove('active'));document.querySelectorAll('.tab-pane').forEach(pane=>pane.classList.add('hidden'));document.getElementById(tabId).classList.remove('hidden');document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active')}
function createArchitecture(){const createLayer=(name,color,z)=>{const geometry=new THREE.BoxGeometry(CONFIG.layer.width,CONFIG.layer.height,0.5);const material=new THREE.MeshStandardMaterial({color,transparent:!0,opacity:0.2,side:THREE.DoubleSide});const mesh=new THREE.Mesh(geometry,material);mesh.position.set(0,0,z);mesh.userData.baseOpacity=0.2;mesh.userData.labelName=name.toLowerCase();scene.add(mesh);addLabel(mesh,name,0,CONFIG.layer.height/2+1.5,0,`Protects ${name.toLowerCase()} operations`);createShield(mesh,color);return mesh};const createComponent=(name,color,x,y,z,size=CONFIG.component.size,tooltip='')=>{const geometry=new THREE.BoxGeometry(size,size,size);const material=new THREE.MeshStandardMaterial({color,roughness:0.3,metalness:0.2});const mesh=new THREE.Mesh(geometry,material);mesh.position.set(x,y,z);mesh.userData.originalColor=color;mesh.userData.labelName=name.toLowerCase().replace(/\W/g,'');scene.add(mesh);addLabel(mesh,name,0,size/2+0.7,0,tooltip);components[name.toLowerCase().replace(/\W/g,'')]=mesh;addGlowEffect(mesh);return mesh};const createShield=(layer,color)=>{const geometry=new THREE.SphereGeometry(CONFIG.layer.width/2,16,16);const material=new THREE.MeshBasicMaterial({color,transparent:!0,opacity:0,wireframe:!0});const shield=new THREE.Mesh(geometry,material);shield.position.copy(layer.position);shield.userData.layer=layer;scene.add(shield);shields.push(shield);animateShield(shield)};const animateShield=(shield)=>{let time=0;function pulseShield(){if(!shield.parent)return;time+=1/60;shield.material.opacity=0.1+0.1*Math.sin(time*2);requestAnimationFrame(pulseShield)}
pulseShield()};const addGlowEffect=(mesh)=>{const glowGeometry=new THREE.BoxGeometry(mesh.geometry.parameters.width*1.2,mesh.geometry.parameters.height*1.2,mesh.geometry.parameters.depth*1.2);const glowMaterial=new THREE.MeshBasicMaterial({color:CONFIG.colors.glow,transparent:!0,opacity:0.2});const glowMesh=new THREE.Mesh(glowGeometry,glowMaterial);glowMesh.position.copy(mesh.position);scene.add(glowMesh);animations.push(glowMesh);let time=0;function animateGlow(){if(!glowMesh.parent)return;time+=1/60;glowMesh.material.opacity=0.2+0.1*Math.sin(time*2);requestAnimationFrame(animateGlow)}
animateGlow()};layers.vanguard=createLayer('Vanguard',CONFIG.colors.vanguard,0);createComponent('User',CONFIG.colors.user,-CONFIG.layer.width/2-6,0,0,undefined,'End-user initiating transactions');createComponent('Browser',CONFIG.colors.user,-CONFIG.layer.width/2+3,0,0,undefined,'Secure client interface');createComponent('MFA',CONFIG.colors.shield,-3,4,0,0.6,'Multi-Factor Authentication (TOTP)');createComponent('WAF',CONFIG.colors.waf,0,4,0,0.6,'Web Application Firewall');createComponent('IDS/IPS',CONFIG.colors.ids,3,4,0,0.6,'Intrusion Detection/Prevention');createComponent('Payment Gateway',CONFIG.colors.gateway,CONFIG.layer.width/2-3,0,0,undefined,'PCI-DSS compliant payments');createComponent('Bot Detection',CONFIG.colors.botDetection,-3,-4,0,0.6,'Blocks malicious bots');createComponent('Rate Limiter',CONFIG.colors.rateLimiter,0,-4,0,0.6,'Limits request rates');createComponent('CSP',CONFIG.colors.csp,3,-4,0,0.6,'Content Security Policy for XSS');createComponent('Geo-Fencing',CONFIG.colors.geoFencing,6,-4,0,0.6,'Location-based access control');layers.asthanguard=createLayer('Asthanguard',CONFIG.colors.asthanguard,-CONFIG.layer.depth);createComponent('Admin',CONFIG.colors.admin,-CONFIG.layer.width/2-6,0,-CONFIG.layer.depth,undefined,'Administrator access');createComponent('Firewall',CONFIG.colors.firewall,-CONFIG.layer.width/2+3,0,-CONFIG.layer.depth,undefined,'Network access control');createComponent('2FA',CONFIG.colors.shield,-3,4,-CONFIG.layer.depth,0.6,'Two-Factor Authentication');createComponent('SIEM',CONFIG.colors.siem,0,4,-CONFIG.layer.depth,0.6,'Security Event Monitoring');createComponent('Encryption Module',CONFIG.colors.encryption,3,4,-CONFIG.layer.depth,0.6,'AES-256 session security');createComponent('EDR',CONFIG.colors.edr,-3,-4,-CONFIG.layer.depth,0.6,'Endpoint Threat Response');createComponent('PAM',CONFIG.colors.pam,0,-4,-CONFIG.layer.depth,0.6,'Privileged Access Management');createComponent('Secure Code Review',CONFIG.colors.secureCode,3,-4,-CONFIG.layer.depth,0.6,'Code integrity checks');createComponent('Behavioral Analytics',CONFIG.colors.behaviorAnalytics,6,-4,-CONFIG.layer.depth,0.6,'Insider threat detection');layers.yudiran=createLayer('Yudiran',CONFIG.colors.yudiran,-CONFIG.layer.depth*2);createComponent('API',CONFIG.colors.encryption,-CONFIG.layer.width/2+3,0,-CONFIG.layer.depth*2,undefined,'Secure API validation');createComponent('Tokenizer',CONFIG.colors.token,-3,0,-CONFIG.layer.depth*2,undefined,'Secures sensitive data');createComponent('Database',CONFIG.colors.database,0,0,-CONFIG.layer.depth*2,undefined,'Encrypted data storage');createComponent('DLP',CONFIG.colors.dlp,3,4,-CONFIG.layer.depth*2,0.6,'Data Loss Prevention');createComponent('Audit Logger',CONFIG.colors.audit,6,4,-CONFIG.layer.depth*2,0.6,'Activity tracking');createComponent('Vulnerability Scanner',CONFIG.colors.vulnScanner,3,-4,-CONFIG.layer.depth*2,0.6,'System weakness detection');createComponent('Backup System',CONFIG.colors.backup,6,-4,-CONFIG.layer.depth*2,0.6,'Data recovery system');createComponent('Zero Trust',CONFIG.colors.zeroTrust,-3,-4,-CONFIG.layer.depth*2,0.6,'Strict access verification');createComponent('Intrusion Recovery',CONFIG.colors.intrusionRecovery,0,-4,-CONFIG.layer.depth*2,0.6,'Post-attack restoration');createComponent('AI Threat Intel',CONFIG.colors.aiThreatIntel,9,-4,-CONFIG.layer.depth*2,0.6,'Predictive threat analysis')}
function addLabel(target,text,x,y,z,tooltip=''){const div=document.createElement('div');div.className='label';div.textContent=text;if(tooltip){const tooltipDiv=document.createElement('div');tooltipDiv.className='tooltip';tooltipDiv.textContent=tooltip;div.appendChild(tooltipDiv)}
const label=new CSS2DObject(div);const offset=new THREE.Vector3(x,y,z);label.position.copy(target.position).add(offset);scene.add(label);labels.push({label,target,offset,name:text.toLowerCase()})}
function updateLabels(activeComponents,activeLayers){labels.forEach(({label,name})=>{const isActive=activeComponents.includes(name)||activeLayers.includes(name);label.element.classList.toggle('hidden',!isActive)})}
function easeInOut(t){return t<0.5?2*t*t:-1+(4-2*t)*t}
function createPacket(startPos,color=CONFIG.colors.packet){const geometry=new THREE.SphereGeometry(0.35,16,16);const material=new THREE.MeshBasicMaterial({color});const packet=new THREE.Mesh(geometry,material);packet.position.copy(startPos);scene.add(packet);animations.push(packet);return packet}
function createConnectionLine(startPos,endPos,color){const points=[startPos.clone(),endPos.clone()];const geometry=new THREE.BufferGeometry().setFromPoints(points);const material=new THREE.LineDashedMaterial({color,linewidth:3,dashSize:0.4,gapSize:0.4});const line=new THREE.Line(geometry,material);line.computeLineDistances();scene.add(line);animations.push(line);return line}
function createParticleEffect(position,color,count=15){const particles=new THREE.Group();for(let i=0;i<count;i++){const geometry=new THREE.SphereGeometry(0.12,8,8);const material=new THREE.MeshBasicMaterial({color});const particle=new THREE.Mesh(geometry,material);particle.position.copy(position);particle.userData.velocity=new THREE.Vector3((Math.random()-0.5)*0.15,(Math.random()-0.5)*0.15,(Math.random()-0.5)*0.15);particles.add(particle)}
scene.add(particles);animations.push(particles);let time=0;function animateParticles(){if(!particles.parent)return;time+=1/60;particles.children.forEach(p=>{p.position.add(p.userData.velocity);p.scale.multiplyScalar(0.92)});if(time<0.8)requestAnimationFrame(animateParticles);else{scene.remove(particles);animations=animations.filter(a=>a!==particles)}}
animateParticles()}
function createWarningIndicator(position){const geometry=new THREE.TetrahedronGeometry(0.5);const material=new THREE.MeshBasicMaterial({color:CONFIG.colors.attack});const indicator=new THREE.Mesh(geometry,material);indicator.position.copy(position).add(new THREE.Vector3(0,1.5,0));scene.add(indicator);animations.push(indicator);let time=0;function pulse(){if(!indicator.parent)return;time+=1/60;indicator.scale.setScalar(1+0.2*Math.sin(time*5));if(time<2)requestAnimationFrame(pulse);else{scene.remove(indicator);animations=animations.filter(a=>a!==indicator)}}
pulse()}
function animatePacket(packet,startPos,endPos,onComplete,speed=CONFIG.animation.packetSpeed){const distance=startPos.distanceTo(endPos);const duration=distance/speed;let elapsed=0;const line=createConnectionLine(startPos,endPos,packet.material.color);function move(){if(!packet.parent)return;elapsed+=1/60;const t=Math.min(1,elapsed/duration);const easedT=easeInOut(t);packet.position.lerpVectors(startPos,endPos,easedT);if(t<1){requestAnimationFrame(move)}else{scene.remove(packet);scene.remove(line);animations=animations.filter(a=>a!==packet&&a!==line);if(onComplete)onComplete();}}
move()}
function highlightComponent(component,color,duration=CONFIG.animation.flashDuration){if(!component||!component.material)return;component.material.emissive.setHex(CONFIG.colors.glow);component.material.emissiveIntensity=0.6;component.material.needsUpdate=!0;const highlight={component,timeout:setTimeout(()=>{if(component.material){component.material.emissive.setHex(0x000000);component.material.emissiveIntensity=0;component.material.needsUpdate=!0}
animations=animations.filter(a=>a!==highlight)},duration)};animations.push(highlight)}
function pulseLayer(layer,duration=CONFIG.animation.pulseDuration){if(!layer||!layer.material)return;layer.material.opacity=0.5;layer.material.needsUpdate=!0;const shield=shields.find(s=>s.userData.layer===layer);if(shield){shield.material.opacity=0.3;shield.material.needsUpdate=!0}
const pulse={layer,shield,timeout:setTimeout(()=>{if(layer.material){layer.material.opacity=layer.userData.baseOpacity;layer.material.needsUpdate=!0}
if(shield){shield.material.opacity=0;shield.material.needsUpdate=!0}
animations=animations.filter(a=>a!==pulse)},duration)};animations.push(pulse)}
function focusCamera(targetPos,duration=600){const startPos=camera.position.clone();const endPos=targetPos.clone().add(new THREE.Vector3(6,4,12));let elapsed=0;function moveCamera(){elapsed+=16;const t=Math.min(1,elapsed/duration);camera.position.lerpVectors(startPos,endPos,easeInOut(t));camera.lookAt(targetPos);if(t<1)requestAnimationFrame(moveCamera);}
moveCamera()}
function updateTimeline(steps,currentIndex){timeline.innerHTML='';steps.forEach((step,index)=>{const stepEl=document.createElement('div');stepEl.className=`timeline-step ${index === currentIndex ? 'active' : ''}`;stepEl.innerHTML=`<i class="fas fa-circle"></i> ${step.info.split(':')[0]}`;stepEl.onclick=()=>{currentStepIndex=index;runSequence(steps,index)};timeline.appendChild(stepEl)})}
function getSimulationElements(type){const simulations={userLogin:{components:['user','browser','waf','idsips','api','mfa','botdetection','ratelimiter','csp','geofencing','zerotrust'],layers:['vanguard','yudiran']},payment:{components:['user','browser','paymentgateway','tokenizer','database','auditlogger','botdetection','zerotrust'],layers:['vanguard','yudiran']},adminAccess:{components:['admin','firewall','encryptionmodule','2fa','siem','api','edr','pam','securecodereview','behavioranalytics','zerotrust'],layers:['asthanguard','yudiran']},bruteForce:{components:['user','browser','waf','ratelimiter'],layers:['vanguard']},ddos:{components:['user','waf','idsips','ratelimiter','geofencing'],layers:['vanguard']},unauthAdmin:{components:['admin','firewall','siem','pam','behavioranalytics'],layers:['asthanguard']},dataExfiltration:{components:['dlp','database','vulnerabilityscanner','zerotrust','aithreatintel'],layers:['yudiran']},sqlInjection:{components:['user','browser','waf','api','botdetection','zerotrust'],layers:['vanguard','yudiran']},xss:{components:['user','browser','waf','botdetection','csp'],layers:['vanguard']},malware:{components:['user','api','idsips','dlp','vulnerabilityscanner','aithreatintel','zerotrust'],layers:['yudiran']},privilegeEscalation:{components:['admin','firewall','2fa','siem','pam','securecodereview'],layers:['asthanguard']},phishing:{components:['user','browser','waf','botdetection','mfa','csp'],layers:['vanguard']},ransomware:{components:['database','dlp','backupsystem','vulnerabilityscanner','intrusionrecovery','aithreatintel','zerotrust'],layers:['yudiran']},insiderThreat:{components:['admin','siem','pam','dlp','auditlogger','zerotrust','behavioranalytics'],layers:['asthanguard','yudiran']},reset:{components:Object.keys(components).map(key=>key.toLowerCase()),layers:Object.keys(layers).map(key=>key.toLowerCase())}};return simulations[type]||{components:[],layers:[]}}
function runSequence(steps,index=0){if(index>=steps.length){const lastStep=steps[steps.length-1]||{info:'Simulation completed',success:!0};infoText.innerHTML=lastStep.success?`<span class="status" style="color: #00ff00;">Success:</span> ${lastStep.info}`:`<span class="status" style="color: #ff0000;">Blocked:</span> ${lastStep.info}`;progressFill.style.width='100%';updateTimeline(steps,steps.length-1);return}
const step=steps[index];console.log(`Running step ${index + 1}: ${step.info}`);infoText.innerHTML=`<span class="status">Step ${index + 1}:</span> ${step.info}`;progressFill.style.width=`${steps.length > 1 ? (index / (steps.length - 1)) * 100 : 100}%`;updateTimeline(steps,index);try{if(step.layer)pulseLayer(step.layer);if(step.focus)focusCamera(step.focus);if(step.warning)createWarningIndicator(step.warning);const activeComponents=[];const activeLayers=[];if(step.from)activeComponents.push(step.from.userData.labelName);if(step.to)activeComponents.push(step.to.userData.labelName);if(step.layer)activeLayers.push(step.layer.userData.labelName);if(step.action){const actionComponents=['waf','idsips','mfa','paymentgateway','tokenizer','database','auditlogger','encryptionmodule','2fa','siem','api','firewall','dlp','botdetection','ratelimiter','edr','pam','vulnerabilityscanner','backupsystem','csp','geofencing','securecodereview','behavioranalytics','zerotrust','intrusionrecovery','aithreatintel'].filter(comp=>step.action.toString().includes(comp));activeComponents.push(...actionComponents)}
updateLabels([...new Set(activeComponents)],[...new Set(activeLayers)]);if(step.action)step.action();if(step.from&&step.to){const packet=createPacket(step.from.position,step.color||CONFIG.colors.packet);animatePacket(packet,step.from.position,step.to.position,()=>{if(step.success)createParticleEffect(step.to.position,CONFIG.colors.success,20);else if(step.blocked)createParticleEffect(step.to.position,step.color||CONFIG.colors.attack,20);runSequence(steps,index+1)})}else{setTimeout(()=>runSequence(steps,index+1),step.action?50:300)}}catch(error){console.error(`Error in step ${index + 1}:`,error);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Error:</span> Simulation failed at step ${index + 1}: ${error.message}`}}
function simulate(type){resetSimulation();infoText.innerHTML=`<span class="status">Starting:</span> ${type.replace(/([A-Z])/g, ' $1').toLowerCase()}`;progressFill.style.width='0%';showTab('overview');if(type!=='reset'){if(attackScenarios.includes(type)){toggleControls()}
const{components:activeComponents,layers:activeLayers}=getSimulationElements(type);updateLabels(activeComponents,activeLayers);setTimeout(()=>{if(attackScenarios.includes(type)){const focusTarget=getAttackFocusTarget(type);if(focusTarget)focusCamera(focusTarget.position);}
runSimulation(type)},2000)}else{runSimulation(type)}}
function getAttackFocusTarget(type){switch(type){case 'bruteForce':case 'ddos':case 'sqlInjection':case 'xss':case 'phishing':return components.waf;case 'unauthAdmin':case 'privilegeEscalation':case 'insiderThreat':return components.firewall;case 'dataExfiltration':case 'ransomware':case 'malware':return components.zerotrust;default:return null}}
function runSimulation(type){const simulations={userLogin:[{from:components.user,to:components.browser,info:"User initiates login.",layer:layers.vanguard,focus:components.browser.position},{from:components.browser,to:components.botdetection,info:"Bot Detection verifies human.",layer:layers.vanguard,action:()=>highlightComponent(components.botdetection,CONFIG.colors.botDetection)},{from:components.botdetection,to:components.waf,info:"WAF validates request.",layer:layers.vanguard,action:()=>highlightComponent(components.waf,CONFIG.colors.waf)},{from:components.waf,to:components.ratelimiter,info:"Rate Limiter checks frequency.",layer:layers.vanguard,action:()=>highlightComponent(components.ratelimiter,CONFIG.colors.rateLimiter)},{from:components.ratelimiter,to:components.csp,info:"CSP ensures secure content.",layer:layers.vanguard,action:()=>highlightComponent(components.csp,CONFIG.colors.csp)},{from:components.csp,to:components.idsips,info:"IDS/IPS scans anomalies.",layer:layers.vanguard,action:()=>highlightComponent(components.idsips,CONFIG.colors.ids)},{from:components.idsips,to:components.api,info:"Request to API.",layer:layers.yudiran},{from:components.api,to:components.zerotrust,info:"Zero Trust verifies access.",layer:layers.yudiran,action:()=>highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust)},{from:components.zerotrust,to:components.mfa,info:"MFA enforces TOTP.",layer:layers.vanguard,action:()=>highlightComponent(components.mfa,CONFIG.colors.shield)},{from:components.mfa,to:components.browser,info:"Login successful.",color:CONFIG.colors.success,success:!0}],payment:[{from:components.user,to:components.browser,info:"User starts payment.",layer:layers.vanguard,focus:components.browser.position},{from:components.browser,to:components.botdetection,info:"Bot Detection confirms user.",layer:layers.vanguard,action:()=>highlightComponent(components.botdetection,CONFIG.colors.botDetection)},{from:components.botdetection,to:components.paymentgateway,info:"Payment Gateway validates.",layer:layers.vanguard,action:()=>highlightComponent(components.paymentgateway,CONFIG.colors.gateway)},{from:components.paymentgateway,to:components.zerotrust,info:"Zero Trust verifies transaction.",layer:layers.yudiran,action:()=>highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust)},{from:components.zerotrust,to:components.tokenizer,info:"Tokenizer secures data.",layer:layers.yudiran,action:()=>highlightComponent(components.tokenizer,CONFIG.colors.token)},{from:components.tokenizer,to:components.database,info:"Token stored in database.",layer:layers.yudiran,action:()=>highlightComponent(components.database,CONFIG.colors.database)},{from:components.database,to:components.auditlogger,info:"Audit Logger records.",layer:layers.yudiran,action:()=>highlightComponent(components.auditlogger,CONFIG.colors.audit)},{from:components.auditlogger,to:components.browser,info:"Payment confirmed.",color:CONFIG.colors.success,success:!0}],adminAccess:[{from:components.admin,to:components.firewall,info:"Admin attempts access.",layer:layers.asthanguard,focus:components.firewall.position},{from:components.firewall,to:components.pam,info:"PAM verifies privileges.",layer:layers.asthanguard,action:()=>highlightComponent(components.pam,CONFIG.colors.pam)},{from:components.pam,to:components.encryptionmodule,info:"Encryption secures session.",layer:layers.asthanguard,action:()=>highlightComponent(components.encryptionmodule,CONFIG.colors.encryption)},{from:components.encryptionmodule,to:components['2fa'],info:"2FA prompts biometrics.",layer:layers.asthanguard,action:()=>highlightComponent(components['2fa'],CONFIG.colors.shield)},{from:components['2fa'],to:components.edr,info:"EDR monitors endpoint.",layer:layers.asthanguard,action:()=>highlightComponent(components.edr,CONFIG.colors.edr)},{from:components.edr,to:components.securecodereview,info:"Code Review ensures integrity.",layer:layers.asthanguard,action:()=>highlightComponent(components.securecodereview,CONFIG.colors.secureCode)},{from:components.securecodereview,to:components.siem,info:"SIEM logs access.",layer:layers.asthanguard,action:()=>highlightComponent(components.siem,CONFIG.colors.siem)},{from:components.siem,to:components.api,info:"Access to backend.",layer:layers.yudiran},{from:components.api,to:components.zerotrust,info:"Zero Trust verifies.",layer:layers.yudiran,action:()=>highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust)},{from:components.zerotrust,to:components.admin,info:"Admin access successful.",color:CONFIG.colors.success,success:!0}],bruteForce:[{from:components.user,to:components.browser,info:"Brute force attempts detected.",layer:layers.vanguard,color:CONFIG.colors.attack,focus:components.browser.position,warning:components.browser.position},{from:components.browser,to:components.ratelimiter,info:"Rate Limiter blocks attempts.",layer:layers.vanguard,color:CONFIG.colors.attack,action:()=>highlightComponent(components.ratelimiter,CONFIG.colors.attack),blocked:!0}],ddos:[{info:"DDoS traffic surge detected.",layer:layers.vanguard,focus:components.waf.position,warning:components.waf.position,action:()=>{highlightComponent(components.waf,CONFIG.colors.attack);highlightComponent(components.ratelimiter,CONFIG.colors.rateLimiter);highlightComponent(components.geofencing,CONFIG.colors.geoFencing);pulseLayer(layers.vanguard);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> DDoS mitigated by WAF, Rate Limiter, and Geo-Fencing.`;createParticleEffect(components.waf.position,CONFIG.colors.attack,25)},blocked:!0}],unauthAdmin:[{from:components.admin,to:components.firewall,info:"Unauthorized admin access.",layer:layers.asthanguard,color:CONFIG.colors.attack,focus:components.firewall.position,warning:components.firewall.position},{info:"Access stopped by security measures.",layer:layers.asthanguard,action:()=>{highlightComponent(components.firewall,CONFIG.colors.attack);highlightComponent(components.pam,CONFIG.colors.pam);highlightComponent(components.behavioranalytics,CONFIG.colors.behaviorAnalytics);pulseLayer(layers.asthanguard);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Access stopped by Firewall, PAM, and Behavioral Analytics.`;createParticleEffect(components.firewall.position,CONFIG.colors.attack,20)},blocked:!0}],dataExfiltration:[{info:"Data exfiltration attempt detected.",layer:layers.yudiran,focus:components.zerotrust.position,action:()=>{const attackerPos=new THREE.Vector3(12,0,components.database.position.z);const packet=createPacket(attackerPos,CONFIG.colors.attack);createWarningIndicator(attackerPos);animatePacket(packet,attackerPos,components.zerotrust.position,()=>{highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust);highlightComponent(components.dlp,CONFIG.colors.dlp);highlightComponent(components.aithreatintel,CONFIG.colors.aiThreatIntel);pulseLayer(layers.yudiran);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Exfiltration stopped by Zero Trust, DLP, and AI Threat Intelligence.`;createParticleEffect(components.zerotrust.position,CONFIG.colors.attack,25)})},blocked:!0}],sqlInjection:[{from:components.user,to:components.browser,info:"SQL injection attempt.",layer:layers.vanguard,color:CONFIG.colors.attack,focus:components.browser.position,warning:components.browser.position},{from:components.browser,to:components.waf,info:"WAF filters SQL payloads.",layer:layers.vanguard,color:CONFIG.colors.attack,action:()=>highlightComponent(components.waf,CONFIG.colors.attack)},{from:components.waf,to:components.api,info:"API validates input.",layer:layers.yudiran,action:()=>highlightComponent(components.api,CONFIG.colors.encryption)},{from:components.api,to:components.zerotrust,info:"Zero Trust rejects attack.",layer:layers.yudiran,action:()=>highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust),blocked:!0}],xss:[{from:components.user,to:components.browser,info:"XSS script injection.",layer:layers.vanguard,color:CONFIG.colors.attack,focus:components.browser.position,warning:components.browser.position},{info:"XSS neutralized by security measures.",layer:layers.vanguard,action:()=>{highlightComponent(components.waf,CONFIG.colors.attack);highlightComponent(components.csp,CONFIG.colors.csp);pulseLayer(layers.vanguard);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> XSS neutralized by WAF and CSP.`;createParticleEffect(components.waf.position,CONFIG.colors.attack,20)},blocked:!0}],malware:[{from:components.user,to:components.api,info:"Malware in API request.",layer:layers.yudiran,color:CONFIG.colors.malware,focus:components.api.position,warning:components.api.position},{info:"Malware stopped by security measures.",layer:layers.yudiran,action:()=>{highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust);highlightComponent(components.vulnerabilityscanner,CONFIG.colors.vulnScanner);highlightComponent(components.aithreatintel,CONFIG.colors.aiThreatIntel);pulseLayer(layers.yudiran);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Malware stopped by Zero Trust, Vulnerability Scanner, and AI Threat Intelligence.`;createParticleEffect(components.zerotrust.position,CONFIG.colors.malware,25)},blocked:!0}],privilegeEscalation:[{from:components.admin,to:components.firewall,info:"Privilege escalation attempt.",layer:layers.asthanguard,color:CONFIG.colors.attack,focus:components.firewall.position,warning:components.firewall.position},{from:components.firewall,to:components['2fa'],info:"2FA blocks privilege gain.",layer:layers.asthanguard,color:CONFIG.colors.attack,action:()=>highlightComponent(components['2fa'],CONFIG.colors.attack)},{info:"Escalation stopped by security measures.",layer:layers.asthanguard,action:()=>{highlightComponent(components.pam,CONFIG.colors.pam);highlightComponent(components.securecodereview,CONFIG.colors.secureCode);pulseLayer(layers.asthanguard);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Escalation stopped by 2FA, PAM, and Secure Code Review.`;createParticleEffect(components.pam.position,CONFIG.colors.attack,20)},blocked:!0}],phishing:[{from:components.user,to:components.browser,info:"Phishing email tricks user.",layer:layers.vanguard,color:CONFIG.colors.attack,focus:components.browser.position,warning:components.browser.position},{from:components.browser,to:components.botdetection,info:"Bot Detection identifies phishing.",layer:layers.vanguard,color:CONFIG.colors.attack,action:()=>highlightComponent(components.botdetection,CONFIG.colors.attack)},{from:components.botdetection,to:components.mfa,info:"MFA prevents theft.",layer:layers.vanguard,action:()=>highlightComponent(components.mfa,CONFIG.colors.attack)},{info:"Phishing stopped by security measures.",layer:layers.vanguard,action:()=>{highlightComponent(components.csp,CONFIG.colors.csp);pulseLayer(layers.vanguard);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Phishing stopped by Bot Detection, MFA, and CSP.`;createParticleEffect(components.mfa.position,CONFIG.colors.attack,20)},blocked:!0}],ransomware:[{info:"Ransomware attempt detected.",layer:layers.yudiran,focus:components.zerotrust.position,action:()=>{const attackerPos=new THREE.Vector3(12,0,components.database.position.z);const packet=createPacket(attackerPos,CONFIG.colors.malware);createWarningIndicator(attackerPos);animatePacket(packet,attackerPos,components.zerotrust.position,()=>{highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust);highlightComponent(components.backupsystem,CONFIG.colors.backup);highlightComponent(components.intrusionrecovery,CONFIG.colors.intrusionRecovery);highlightComponent(components.aithreatintel,CONFIG.colors.aiThreatIntel);pulseLayer(layers.yudiran);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Ransomware stopped by Zero Trust, Backup System, Intrusion Recovery, and AI Threat Intelligence.`;createParticleEffect(components.zerotrust.position,CONFIG.colors.malware,25)})},blocked:!0}],insiderThreat:[{from:components.admin,to:components.siem,info:"Insider attempts data access.",layer:layers.asthanguard,color:CONFIG.colors.attack,focus:components.siem.position,warning:components.siem.position},{from:components.siem,to:components.pam,info:"PAM restricts access.",layer:layers.asthanguard,color:CONFIG.colors.attack,action:()=>highlightComponent(components.pam,CONFIG.colors.attack)},{from:components.pam,to:components.dlp,info:"DLP detects data movement.",layer:layers.yudiran,action:()=>highlightComponent(components.dlp,CONFIG.colors.dlp)},{from:components.dlp,to:components.zerotrust,info:"Zero Trust enforces verification.",layer:layers.yudiran,action:()=>highlightComponent(components.zerotrust,CONFIG.colors.zeroTrust)},{info:"Insider threat stopped by security measures.",layer:layers.yudiran,action:()=>{highlightComponent(components.auditlogger,CONFIG.colors.audit);highlightComponent(components.aithreatintel,CONFIG.colors.aiThreatIntel);pulseLayer(layers.yudiran);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Blocked:</span> Insider threat stopped by PAM, DLP, Zero Trust, and AI Threat Intelligence.`;createParticleEffect(components.zerotrust.position,CONFIG.colors.attack,20)},blocked:!0}],reset:[]};const{components:activeComponents,layers:activeLayers}=getSimulationElements(type);const missingComponents=activeComponents.filter(comp=>!components[comp]);const missingLayers=activeLayers.filter(layer=>!layers[layer]);if(missingComponents.length||missingLayers.length){console.error(`Simulation ${type} failed: Missing components [${missingComponents}] or layers [${missingLayers}]`);infoText.innerHTML=`<span class="status" style="color: #ff0000;">Error:</span> Simulation ${type} cannot run due to missing components or layers.`;return}
Object.keys(components).forEach(key=>{components[key].userData.labelName=key.toLowerCase()});Object.keys(layers).forEach(key=>{layers[key].userData.labelName=key.toLowerCase()});currentSimulationSteps=simulations[type]||[];currentStepIndex=0;if(type==='reset'){resetSimulation()}else{runSequence(currentSimulationSteps)}}
function resetSimulation(){infoText.innerHTML="Simulation reset. Select an action to begin.";progressFill.style.width='0%';timeline.innerHTML='';currentSimulationSteps=[];currentStepIndex=0;animations.forEach(anim=>{if(anim.isMesh||anim.isLine||anim.isGroup)scene.remove(anim);if(anim.timeout)clearTimeout(anim.timeout);if(anim.component&&anim.component.material){anim.component.material.emissive.setHex(0x000000);anim.component.material.emissiveIntensity=0;anim.component.material.needsUpdate=!0}
if(anim.layer&&anim.layer.material){anim.layer.material.opacity=anim.layer.userData.baseOpacity;anim.layer.material.needsUpdate=!0}
if(anim.shield&&anim.shield.material){anim.shield.material.opacity=0;anim.shield.material.needsUpdate=!0}});animations=[];labels.forEach(({label})=>scene.remove(label));labels=[];shields.forEach(shield=>scene.remove(shield));shields=[];components={};layers={};createArchitecture();theta=Math.PI/2;phi=0;updateCameraPosition();showTab('overview');updateLabels(Object.keys(components).map(key=>key.toLowerCase()),Object.keys(layers).map(key=>key.toLowerCase()))}
function animate(){requestAnimationFrame(animate);labels.forEach(({label,target,offset})=>{label.position.copy(target.position).add(offset)});renderer.render(scene,camera);labelRenderer.render(scene,camera)}
window.simulate=simulate;window.resetSimulation=resetSimulation;window.showTab=showTab;window.toggleControls=toggleControls;window.toggleInfo=toggleInfo;initScene();</script></body></html>

